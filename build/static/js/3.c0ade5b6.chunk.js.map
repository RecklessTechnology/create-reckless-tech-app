{"version":3,"sources":["@RecklessCore/ThreeObjects/Render/view.js","@RecklessCore/ThreeObjects/Managers/ThreeObjectManager.js","@RecklessCore/ThreeObjects/Render/index.js","@RecklessCore/Scenes/Render/Dynamic/index.js"],"names":["RenderThreeChildrenView","name","node","position","rotation","scale","children","ref","memo","ThreeObjectContext","createContext","ThreeObjectPositionContext","ThreeObjectRotationContext","ThreeObjectScaleContext","DefaultProps","uuid","type","displayName","disabled","debug","ThreeObjectManager","props","isMounted","useRef","useAppContext","sceneJSON","subscribe","unsubscribe","publish","connections","identifier","Symbol","useState","setDisabled","setDebug","setPosition","setRotation","setScale","updateFromInput","prop","val","toLowerCase","useEffect","filter","c","to","forEach","from","fromProp","toProp","current","useThreeObjectsContext","registerThreeObject","unregisterThreeObject","forceUpdate","useForceUpdate","threeObjectRef","useMemo","id","getRef","useCallback","contextValue","nodeRef","positionContextValue","rotationContextValue","scaleContextValue","Provider","value","whyDidYouRender","process","RenderThreeChildren","passedProps","geometries","materials","devices","generators","childRef","objProps","threeObj","THREE","propKeys","Object","keys","undefined","filteredProps","key","includes","reduce","obj","usedProps","layers","geometry","material","shadow","params","parameters","args","map","param","userData","isPatchHidden","matrixAutoUpdate","geo","g","geoProps","matrix","push","mat","m","matProps","matGeoChildren","createElement","useFrame","state","uniforms","time","clock","elapsedTime","objChildren","length","childProps","DynamicScene","object","Render"],"mappings":"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","file":"static/js/3.c0ade5b6.chunk.js","sourcesContent":["import PropTypes from 'prop-types';\n\nimport React, { memo } from 'react';\n\nconst RenderThreeChildrenView = ({\n  name,\n  node,\n  position,\n  rotation,\n  scale,\n  children,\n}) => (\n  <group name={name} ref={node} position={position} rotation={rotation} scale={scale}>\n    {children}\n  </group>\n);\n\nRenderThreeChildrenView.propTypes = {\n  children: PropTypes.node.isRequired,\n  name: PropTypes.string.isRequired,\n  node: PropTypes.shape().isRequired,\n  position: PropTypes.arrayOf(PropTypes.number).isRequired,\n  rotation: PropTypes.arrayOf(PropTypes.number).isRequired,\n  scale: PropTypes.arrayOf(PropTypes.number).isRequired,\n};\n\nexport default memo(RenderThreeChildrenView);\n","import PropTypes from 'prop-types';\n\nimport React, {\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  useEffect,\n  createContext,\n} from 'react';\nimport useForceUpdate from '../../Utils/useForceUpdate';\n\nimport useThreeObjectsContext from '../Contexts/useThreeObjectsContext';\nimport useAppContext from '../../App/Contexts/useAppContext';\n\nimport RenderThreeChildrenView from '../Render/view';\n\nexport const ThreeObjectContext = createContext(null);\nexport const ThreeObjectPositionContext = createContext(null);\nexport const ThreeObjectRotationContext = createContext(null);\nexport const ThreeObjectScaleContext = createContext(null);\n\nexport const DefaultProps = {\n  uuid: 'xxx',\n  name: 'unnamed',\n  type: 'three-object',\n  displayName: 'unnamed',\n  disabled: false,\n  debug: false,\n  position: [0, 0, 0],\n  rotation: [0, 0, 0],\n  scale: [1, 1, 1],\n};\n\nconst ThreeObjectManager = ({\n  name,\n  displayName,\n  type,\n  children,\n  ...props\n}) => {\n  const isMounted = useRef(false);\n\n  const {\n    sceneJSON, subscribe, unsubscribe, publish,\n  } = useAppContext();\n  const { connections } = sceneJSON;\n\n  const identifier = useRef(Symbol('ThreeObject'));\n  const node = useRef(null);\n\n  const [uuid] = useState(props.uuid);\n\n  const [disabled, setDisabled] = useState(props.disabled || false);\n  const [debug, setDebug] = useState(props.debug || false);\n\n  const [position, setPosition] = useState(props.position || [0, 0, 0]);\n  const [rotation, setRotation] = useState(props.rotation || [0, 0, 0]);\n  const [scale, setScale] = useState(props.scale || [1, 1, 1]);\n\n  // Inputs\n  const updateFromInput = (prop, val) => {\n    switch (prop.toLowerCase()) {\n      default:\n        break;\n      case 'position':\n        setPosition(val);\n        break;\n      case 'rotation':\n        setRotation(val);\n        break;\n      case 'scale':\n        setScale(val);\n        break;\n    }\n  };\n\n  useEffect(() => {\n    connections.filter((c) => (c.to === uuid)).forEach((c) => {\n      subscribe(`${c.from}-${c.fromProp.toLowerCase()}-updated`, (val) => { updateFromInput(c.toProp.toLowerCase(), val); });\n    });\n    return () => {\n      connections.filter((c) => (c.to === uuid)).forEach((c) => {\n        unsubscribe(`${c.from}-${c.fromProp.toLowerCase()}-updated`, (val) => { updateFromInput(c.toProp.toLowerCase(), val); });\n      });\n    };\n  }, [connections, uuid, subscribe, unsubscribe]);\n\n  // Outputs\n\n  // Limit publish events to once every...\n  // const broadcastThrottle = 1000/60;\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-disabled-updated`, disabled);\n    }\n  }, [disabled, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-debug-updated`, debug);\n    }\n  }, [debug, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-position-updated`, position);\n    }\n  }, [position, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-rotation-updated`, rotation);\n    }\n  }, [rotation, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-scale-updated`, scale);\n    }\n  }, [scale, publish, uuid]);\n\n  const { registerThreeObject, unregisterThreeObject } = useThreeObjectsContext();\n  const forceUpdate = useForceUpdate();\n\n  // Reference to object properties\n  const threeObjectRef = useMemo(\n    () => ({\n      uuid,\n      id: identifier.current,\n\n      name,\n      displayName,\n      type,\n\n      disabled,\n      setDisabled,\n      debug,\n      setDebug,\n\n      position,\n      setPosition,\n      rotation,\n      setRotation,\n      scale,\n      setScale,\n    }),\n    [\n      uuid,\n      name, displayName, type,\n\n      disabled, setDisabled,\n      debug, setDebug,\n\n      position, setPosition,\n      rotation, setRotation,\n      scale, setScale,\n    ],\n  );\n\n  // Callback to fetch properties of object\n  const getRef = useCallback(() => threeObjectRef, [threeObjectRef]);\n\n  // On load, register object with app context\n  useEffect(() => {\n    isMounted.current = true;\n    registerThreeObject(uuid, threeObjectRef);\n    return () => {\n      isMounted.current = false;\n      unregisterThreeObject(uuid, threeObjectRef);\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Final context for provider\n  const contextValue = useMemo(() => ({\n    uuid,\n    id: identifier.current,\n    name,\n    nodeRef: node,\n    getRef,\n\n    disabled,\n    setDisabled,\n    debug,\n    setDebug,\n\n    setPosition,\n    setRotation,\n    setScale,\n\n    forceUpdate,\n  }), [\n    uuid,\n    identifier,\n    name,\n    node,\n    getRef,\n    disabled, setDisabled,\n    debug, setDebug,\n    setPosition,\n    setRotation,\n    setScale,\n    forceUpdate,\n  ]);\n\n  const positionContextValue = useMemo(() => ({ position }), [position]);\n  const rotationContextValue = useMemo(() => ({ rotation }), [rotation]);\n  const scaleContextValue = useMemo(() => ({ scale }), [scale]);\n\n  return (\n    <ThreeObjectContext.Provider value={contextValue}>\n      <ThreeObjectPositionContext.Provider value={positionContextValue}>\n        <ThreeObjectRotationContext.Provider value={rotationContextValue}>\n          <ThreeObjectScaleContext.Provider value={scaleContextValue}>\n            <RenderThreeChildrenView {...{\n              name,\n              node,\n              position,\n              rotation,\n              scale,\n            }}\n            >\n              {!disabled ? children : []}\n            </RenderThreeChildrenView>\n          </ThreeObjectScaleContext.Provider>\n        </ThreeObjectRotationContext.Provider>\n      </ThreeObjectPositionContext.Provider>\n    </ThreeObjectContext.Provider>\n  );\n};\n\nThreeObjectManager.whyDidYouRender = (process.env.NODE_ENV === 'development');\n\nThreeObjectManager.propTypes = {\n  children: PropTypes.node.isRequired,\n  uuid: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  displayName: PropTypes.string.isRequired,\n  disabled: PropTypes.bool.isRequired,\n  debug: PropTypes.bool.isRequired,\n  position: PropTypes.arrayOf(PropTypes.number).isRequired,\n  rotation: PropTypes.arrayOf(PropTypes.number).isRequired,\n  scale: PropTypes.arrayOf(PropTypes.number).isRequired,\n};\n\nexport default ThreeObjectManager;\n","import PropTypes from 'prop-types';\n\nimport React, { useRef, createElement, useMemo } from 'react';\n\nimport { useFrame } from '@react-three/fiber';\n\nimport * as THREE from 'three';\n\nimport ThreeObjectManager, { DefaultProps } from '../Managers/ThreeObjectManager';\n\n// Recursive function to convert THREE.js Object Scene to @react-three/fiber objects\n// https://github.com/mrdoob/three.js/wiki/JSON-Object-Scene-format-4\nconst RenderThreeChildren = ({\n  props: passedProps,\n  geometries,\n  materials,\n  devices,\n  generators,\n  connections,\n}) => {\n  const childRef = useRef();\n\n  const objProps = useMemo(() => {\n    const threeObj = new THREE[passedProps.type]();\n    const propKeys = Object.keys(passedProps).filter((prop) => threeObj[prop] !== undefined);\n    const filteredProps = propKeys\n      .filter((key) => propKeys.includes(key))\n      .reduce((obj, key) => ({\n        ...obj,\n        [key]: passedProps[key],\n      }), {});\n    const {\n      layers,\n      geometry, material,\n      children,\n      shadow,\n      ...usedProps\n    } = filteredProps;\n\n    const params = threeObj.parameters;\n    const args = params === undefined ? [] : Object.keys(params).map((param) => passedProps[param]);\n\n    return {\n      userData: {\n        isPatchHidden: false,\n      },\n      ...usedProps,\n      key: passedProps.uuid,\n      args,\n      childRef,\n      matrixAutoUpdate: false,\n    };\n  }, [passedProps]);\n\n  const geo = useMemo(() => geometries.filter((g) => g.uuid === passedProps.geometry)[0],\n    [passedProps, geometries]);\n\n  const geoProps = useMemo(() => {\n    if (geo === undefined) return {};\n    const threeObj = new THREE[geo.type]();\n\n    const propKeys = Object.keys(geo).filter((prop) => threeObj[prop] !== undefined);\n    const filteredProps = propKeys\n      .filter((key) => propKeys.includes(key))\n      .reduce((obj, key) => ({\n        ...obj,\n        [key]: geo[key],\n      }), {});\n    const {\n      uuid, type,\n      geometry, material,\n      children,\n      matrix,\n      ...usedProps\n    } = filteredProps;\n\n    const params = threeObj.parameters;\n    const args = params === undefined ? [] : Object.keys(params).map((param) => geo[param]);\n\n    args.push(usedProps);\n\n    return {\n      key: geo.uuid,\n      args,\n    };\n  }, [geo]);\n\n  const mat = useMemo(() => materials.filter((m) => m.uuid === passedProps.material)[0],\n    [passedProps, materials]);\n  const matProps = useMemo(() => {\n    if (mat === undefined) return {};\n    const threeObj = new THREE[mat.type]();\n\n    const propKeys = Object.keys(mat).filter((prop) => threeObj[prop] !== undefined);\n    const filteredProps = propKeys\n      .filter((key) => propKeys.includes(key))\n      .reduce((obj, key) => ({\n        ...obj,\n        [key]: mat[key],\n      }), {});\n    const {\n      uuid, type,\n      geometry, material,\n      children,\n      matrix,\n      ...usedProps\n    } = filteredProps;\n\n    const params = threeObj.parameters;\n    const args = params === undefined ? [] : Object.keys(params).map((param) => mat[param]);\n\n    args.push(usedProps);\n\n    return {\n      key: mat.uuid,\n      args,\n    };\n  }, [mat]);\n\n  // Only need material and geometry for objects\n  const matGeoChildren = (passedProps.geometry !== undefined\n    && passedProps.material !== undefined) ? [\n      createElement(geo.type, geoProps, []),\n      createElement(mat.type, matProps, []),\n    ] : [];\n\n  // TODO: More robust way to handle uniform values\n  useFrame((state) => {\n    if (childRef.current) {\n      if (childRef.current.material) {\n        if (childRef.current.material.uniforms) {\n          if (childRef.current.material.uniforms.time) {\n            childRef.current.material.uniforms.time.value = state.clock.elapsedTime;\n          }\n        }\n      }\n    }\n  });\n\n  let objChildren = [];\n\n  if (passedProps.children && passedProps.children.length > 0) {\n    objChildren = passedProps.children.map((childProps) => (\n      <RenderThreeChildren\n        {...{\n          key: childProps.uuid,\n          props: childProps,\n          geometries,\n          materials,\n          devices,\n          generators,\n          connections,\n        }}\n      />\n    ));\n  }\n\n  return (\n    <ThreeObjectManager key={`rt_${passedProps.uuid}`} {...DefaultProps} type={passedProps.type} {...passedProps}>\n      {createElement(\n        passedProps.type,\n        objProps,\n        [\n          ...matGeoChildren,\n          ...objChildren,\n        ],\n      )}\n    </ThreeObjectManager>\n  );\n};\n\nRenderThreeChildren.whyDidYouRender = (process.env.NODE_ENV === 'development');\n\nRenderThreeChildren.propTypes = {\n  props: PropTypes.shape({\n    type: PropTypes.string,\n    uuid: PropTypes.string,\n  }).isRequired,\n  geometries: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  materials: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  devices: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  generators: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  connections: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n};\n\nexport default RenderThreeChildren;\n","import PropTypes from 'prop-types';\n\nimport React, { memo } from 'react';\n\nimport RenderThreeChildren from '../../../ThreeObjects/Render';\n\nconst DynamicScene = ({ sceneJSON }) => {\n  const {\n    object,\n    geometries,\n    materials,\n    devices,\n    generators,\n    connections,\n  } = sceneJSON;\n  return (object.children.map((childProps) => (\n    <RenderThreeChildren\n      key={childProps.uuid}\n      props={childProps}\n      geometries={geometries}\n      materials={materials}\n      devices={devices}\n      generators={generators}\n      connections={connections}\n    />\n  )));\n};\n\nDynamicScene.whyDidYouRender = (process.env.NODE_ENV === 'development');\n\nDynamicScene.propTypes = {\n  sceneJSON: PropTypes.shape().isRequired,\n};\n\nexport default memo(DynamicScene);\n"],"sourceRoot":""}