{"version":3,"sources":["@RecklessCore/ThreeObjects/Components/gltf.js","@RecklessCore/ThreeObjects/view.js","@RecklessCore/ThreeObjects/Managers/ThreeObjectManager.js","@RecklessCore/ThreeObjects/index.js","@RecklessCore/Scenes/Renderer/Dynamic/index.js"],"names":["GLTFObject","props","url","scene","useGLTF","dispose","fallback","object","memo","ThreeObjectView","name","node","position","rotation","scale","children","ref","ThreeObjectContext","createContext","ThreeObjectPositionContext","ThreeObjectRotationContext","ThreeObjectScaleContext","DefaultProps","uuid","type","disabled","debug","ThreeObjectManager","isMounted","useRef","useAppContext","sceneJSON","subscribe","unsubscribe","publish","connections","identifier","Symbol","useState","setDisabled","setDebug","setPosition","setRotation","setScale","updateFromInput","prop","val","toLowerCase","useEffect","filter","c","to","forEach","from","fromProp","toProp","current","useThreeObjectsContext","registerThreeObject","unregisterThreeObject","forceUpdate","useForceUpdate","threeObjectRef","useMemo","id","getRef","useCallback","contextValue","nodeRef","positionContextValue","rotationContextValue","scaleContextValue","Provider","value","whyDidYouRender","process","ThreeObject","passedProps","geometries","materials","devices","generators","childRef","objProps","threeObj","undefined","THREE","propKeys","Object","keys","filteredProps","key","includes","reduce","obj","usedProps","layers","geometry","material","shadow","params","parameters","args","map","param","userData","isPatchHidden","matrixAutoUpdate","geo","g","geoProps","matrix","push","mat","m","matProps","matGeoChildren","createElement","useFrame","state","uniforms","time","clock","elapsedTime","objChildren","length","childProps","DynamicScene"],"mappings":"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","file":"static/js/3.45b0e7cf.chunk.js","sourcesContent":["import PropTypes from 'prop-types';\n\nimport React, { memo, Suspense } from 'react';\n\nimport { useGLTF } from '@react-three/drei';\n\nconst GLTFObject = (props) => {\n  const { url } = props;\n  const { scene } = useGLTF(url);\n  return (\n    <group dispose={null}>\n      <Suspense fallback={null}>\n        <primitive object={scene} {...props} />\n      </Suspense>\n    </group>\n  );\n};\n\nGLTFObject.propTypes = {\n  url: PropTypes.string.isRequired,\n};\n\nexport default memo(GLTFObject);\n","import PropTypes from 'prop-types';\n\nimport React, { memo } from 'react';\n\nconst ThreeObjectView = ({\n  name,\n  node,\n  position,\n  rotation,\n  scale,\n  children,\n}) => (\n  <group name={name} ref={node} position={position} rotation={rotation} scale={scale}>\n    {children}\n  </group>\n);\n\nThreeObjectView.propTypes = {\n  children: PropTypes.node.isRequired,\n  name: PropTypes.string.isRequired,\n  node: PropTypes.shape().isRequired,\n  position: PropTypes.arrayOf(PropTypes.number).isRequired,\n  rotation: PropTypes.arrayOf(PropTypes.number).isRequired,\n  scale: PropTypes.arrayOf(PropTypes.number).isRequired,\n};\n\nexport default memo(ThreeObjectView);\n","import PropTypes from 'prop-types';\n\nimport React, {\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  useEffect,\n  createContext,\n} from 'react';\nimport useForceUpdate from '../../Utils/useForceUpdate';\n\nimport useThreeObjectsContext from '../Contexts/useThreeObjectsContext';\nimport useAppContext from '../../App/Contexts/useAppContext';\n\nimport ThreeObjectView from '../view';\n\nexport const ThreeObjectContext = createContext(null);\nexport const ThreeObjectPositionContext = createContext(null);\nexport const ThreeObjectRotationContext = createContext(null);\nexport const ThreeObjectScaleContext = createContext(null);\n\nexport const DefaultProps = {\n  uuid: 'xxx',\n  name: 'unnamed',\n  type: 'three-object',\n  disabled: false,\n  debug: false,\n  position: [0, 0, 0],\n  rotation: [0, 0, 0],\n  scale: [1, 1, 1],\n};\n\nconst ThreeObjectManager = ({\n  name,\n  type,\n  children,\n  ...props\n}) => {\n  const isMounted = useRef(false);\n\n  const {\n    sceneJSON, subscribe, unsubscribe, publish,\n  } = useAppContext();\n  const { connections } = sceneJSON;\n\n  const identifier = useRef(Symbol('ThreeObject'));\n  const node = useRef(null);\n\n  const [uuid] = useState(props.uuid);\n\n  const [disabled, setDisabled] = useState(props.disabled || false);\n  const [debug, setDebug] = useState(props.debug || false);\n\n  const [position, setPosition] = useState(props.position || [0, 0, 0]);\n  const [rotation, setRotation] = useState(props.rotation || [0, 0, 0]);\n  const [scale, setScale] = useState(props.scale || [1, 1, 1]);\n\n  // Inputs\n  const updateFromInput = (prop, val) => {\n    switch (prop.toLowerCase()) {\n      default:\n        break;\n      case 'position':\n        setPosition(val);\n        break;\n      case 'rotation':\n        setRotation(val);\n        break;\n      case 'scale':\n        setScale(val);\n        break;\n    }\n  };\n\n  useEffect(() => {\n    connections.filter((c) => (c.to === uuid)).forEach((c) => {\n      subscribe(`${c.from}-${c.fromProp.toLowerCase()}-updated`, (val) => { updateFromInput(c.toProp.toLowerCase(), val); });\n    });\n    return () => {\n      connections.filter((c) => (c.to === uuid)).forEach((c) => {\n        unsubscribe(`${c.from}-${c.fromProp.toLowerCase()}-updated`, (val) => { updateFromInput(c.toProp.toLowerCase(), val); });\n      });\n    };\n  }, [connections, uuid, subscribe, unsubscribe]);\n\n  // Outputs\n\n  // Limit publish events to once every...\n  // const broadcastThrottle = 1000/60;\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-disabled-updated`, disabled);\n    }\n  }, [disabled, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-debug-updated`, debug);\n    }\n  }, [debug, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-position-updated`, position);\n    }\n  }, [position, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-rotation-updated`, rotation);\n    }\n  }, [rotation, publish, uuid]);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      publish(`${uuid}-scale-updated`, scale);\n    }\n  }, [scale, publish, uuid]);\n\n  const { registerThreeObject, unregisterThreeObject } = useThreeObjectsContext();\n  const forceUpdate = useForceUpdate();\n\n  // Reference to object properties\n  const threeObjectRef = useMemo(\n    () => ({\n      uuid,\n      id: identifier.current,\n\n      name,\n      type,\n\n      disabled,\n      setDisabled,\n      debug,\n      setDebug,\n\n      position,\n      setPosition,\n      rotation,\n      setRotation,\n      scale,\n      setScale,\n    }),\n    [\n      uuid,\n      name, type,\n\n      disabled, setDisabled,\n      debug, setDebug,\n\n      position, setPosition,\n      rotation, setRotation,\n      scale, setScale,\n    ],\n  );\n\n  // Callback to fetch properties of object\n  const getRef = useCallback(() => threeObjectRef, [threeObjectRef]);\n\n  // On load, register object with app context\n  useEffect(() => {\n    isMounted.current = true;\n    registerThreeObject(uuid, threeObjectRef);\n    return () => {\n      isMounted.current = false;\n      unregisterThreeObject(uuid, threeObjectRef);\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Final context for provider\n  const contextValue = useMemo(() => ({\n    uuid,\n    id: identifier.current,\n    name,\n    nodeRef: node,\n    getRef,\n\n    disabled,\n    setDisabled,\n    debug,\n    setDebug,\n\n    setPosition,\n    setRotation,\n    setScale,\n\n    forceUpdate,\n  }), [\n    uuid,\n    identifier,\n    name,\n    node,\n    getRef,\n    disabled, setDisabled,\n    debug, setDebug,\n    setPosition,\n    setRotation,\n    setScale,\n    forceUpdate,\n  ]);\n\n  const positionContextValue = useMemo(() => ({ position }), [position]);\n  const rotationContextValue = useMemo(() => ({ rotation }), [rotation]);\n  const scaleContextValue = useMemo(() => ({ scale }), [scale]);\n\n  return (\n    <ThreeObjectContext.Provider value={contextValue}>\n      <ThreeObjectPositionContext.Provider value={positionContextValue}>\n        <ThreeObjectRotationContext.Provider value={rotationContextValue}>\n          <ThreeObjectScaleContext.Provider value={scaleContextValue}>\n            <ThreeObjectView {...{\n              name,\n              node,\n              position,\n              rotation,\n              scale,\n            }}\n            >\n              {!disabled ? children : []}\n            </ThreeObjectView>\n          </ThreeObjectScaleContext.Provider>\n        </ThreeObjectRotationContext.Provider>\n      </ThreeObjectPositionContext.Provider>\n    </ThreeObjectContext.Provider>\n  );\n};\n\nThreeObjectManager.whyDidYouRender = (process.env.NODE_ENV === 'development');\n\nThreeObjectManager.propTypes = {\n  children: PropTypes.node.isRequired,\n  uuid: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  disabled: PropTypes.bool.isRequired,\n  debug: PropTypes.bool.isRequired,\n  position: PropTypes.arrayOf(PropTypes.number).isRequired,\n  rotation: PropTypes.arrayOf(PropTypes.number).isRequired,\n  scale: PropTypes.arrayOf(PropTypes.number).isRequired,\n};\n\nexport default ThreeObjectManager;\n","import PropTypes from 'prop-types';\n\nimport React, { useRef, createElement, useMemo } from 'react';\n\nimport { useFrame } from '@react-three/fiber';\n\nimport * as THREE from 'three';\n\nimport GLTFObject from './Components/gltf';\n\nimport ThreeObjectManager, { DefaultProps } from './Managers/ThreeObjectManager';\n\n// Recursive function to convert THREE.js Object Scene to @react-three/fiber objects\n// https://github.com/mrdoob/three.js/wiki/JSON-Object-Scene-format-4\nconst ThreeObject = ({\n  props: passedProps,\n  geometries,\n  materials,\n  devices,\n  generators,\n  connections,\n}) => {\n  const childRef = useRef();\n\n  const objProps = useMemo(() => {\n    const threeObj = (THREE[passedProps.type] === undefined) ? {} : new THREE[passedProps.type]();\n    const propKeys = Object.keys(passedProps).filter((prop) => threeObj[prop] !== undefined);\n    const filteredProps = propKeys\n      .filter((key) => propKeys.includes(key))\n      .reduce((obj, key) => ({\n        ...obj,\n        [key]: passedProps[key],\n      }), {});\n    const {\n      layers,\n      geometry, material,\n      children,\n      shadow,\n      ...usedProps\n    } = filteredProps;\n\n    const params = threeObj.parameters;\n    const args = params === undefined ? [] : Object.keys(params).map((param) => passedProps[param]);\n\n    return {\n      userData: {\n        isPatchHidden: false,\n      },\n      ...usedProps,\n      key: passedProps.uuid,\n      args,\n      childRef,\n      matrixAutoUpdate: false,\n    };\n  }, [passedProps]);\n\n  const geo = useMemo(() => geometries.filter((g) => g.uuid === passedProps.geometry)[0],\n    [passedProps, geometries]);\n\n  const geoProps = useMemo(() => {\n    if (geo === undefined) return {};\n    const threeObj = new THREE[geo.type]();\n\n    const propKeys = Object.keys(geo).filter((prop) => threeObj[prop] !== undefined);\n    const filteredProps = propKeys\n      .filter((key) => propKeys.includes(key))\n      .reduce((obj, key) => ({\n        ...obj,\n        [key]: geo[key],\n      }), {});\n    const {\n      uuid, type,\n      geometry, material,\n      children,\n      matrix,\n      ...usedProps\n    } = filteredProps;\n\n    const params = threeObj.parameters;\n    const args = params === undefined ? [] : Object.keys(params).map((param) => geo[param]);\n\n    args.push(usedProps);\n\n    return {\n      key: geo.uuid,\n      args,\n    };\n  }, [geo]);\n\n  const mat = useMemo(() => materials.filter((m) => m.uuid === passedProps.material)[0],\n    [passedProps, materials]);\n  const matProps = useMemo(() => {\n    if (mat === undefined) return {};\n    const threeObj = new THREE[mat.type]();\n\n    const propKeys = Object.keys(mat).filter((prop) => threeObj[prop] !== undefined);\n    const filteredProps = propKeys\n      .filter((key) => propKeys.includes(key))\n      .reduce((obj, key) => ({\n        ...obj,\n        [key]: mat[key],\n      }), {});\n    const {\n      uuid, type,\n      geometry, material,\n      children,\n      matrix,\n      ...usedProps\n    } = filteredProps;\n\n    const params = threeObj.parameters;\n    const args = params === undefined ? [] : Object.keys(params).map((param) => mat[param]);\n\n    args.push(usedProps);\n\n    return {\n      key: mat.uuid,\n      args,\n    };\n  }, [mat]);\n\n  // Only need material and geometry for objects\n  const matGeoChildren = (passedProps.geometry !== undefined\n    && passedProps.material !== undefined) ? [\n      createElement(geo.type, geoProps, []),\n      createElement(mat.type, matProps, []),\n    ] : [];\n\n  // TODO: More robust way to handle uniform values\n  useFrame((state) => {\n    if (childRef.current) {\n      if (childRef.current.material) {\n        if (childRef.current.material.uniforms) {\n          if (childRef.current.material.uniforms.time) {\n            childRef.current.material.uniforms.time.value = state.clock.elapsedTime;\n          }\n        }\n      }\n    }\n  });\n\n  let objChildren = [];\n\n  if (passedProps.children && passedProps.children.length > 0) {\n    objChildren = passedProps.children.map((childProps) => (\n      <ThreeObject\n        {...{\n          key: childProps.uuid,\n          props: childProps,\n          geometries,\n          materials,\n          devices,\n          generators,\n          connections,\n        }}\n      />\n    ));\n  }\n\n  switch (passedProps.type) {\n    case 'GLTF':\n      return (\n        <ThreeObjectManager key={`rt_${passedProps.uuid}`} {...DefaultProps} type={passedProps.type} {...passedProps}>\n          <GLTFObject {...{ ...passedProps }} />\n        </ThreeObjectManager>\n      );\n    default:\n      return (\n        <ThreeObjectManager key={`rt_${passedProps.uuid}`} {...DefaultProps} type={passedProps.type} {...passedProps}>\n          {createElement(\n            passedProps.type,\n            objProps,\n            [\n              ...matGeoChildren,\n              ...objChildren,\n            ],\n          )}\n        </ThreeObjectManager>\n      );\n  }\n};\n\nThreeObject.whyDidYouRender = (process.env.NODE_ENV === 'development');\n\nThreeObject.propTypes = {\n  props: PropTypes.shape({\n    type: PropTypes.string,\n    uuid: PropTypes.string,\n  }).isRequired,\n  geometries: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  materials: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  devices: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  generators: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  connections: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n};\n\nexport default ThreeObject;\n","import PropTypes from 'prop-types';\n\nimport React, { memo } from 'react';\n\nimport ThreeObject from '../../../ThreeObjects';\n\nconst DynamicScene = ({ sceneJSON }) => {\n  const {\n    object,\n    geometries,\n    materials,\n    devices,\n    generators,\n    connections,\n  } = sceneJSON;\n  return (object.children.map((childProps) => (\n    <ThreeObject\n      key={childProps.uuid}\n      props={childProps}\n      geometries={geometries}\n      materials={materials}\n      devices={devices}\n      generators={generators}\n      connections={connections}\n    />\n  )));\n};\n\nDynamicScene.whyDidYouRender = (process.env.NODE_ENV === 'development');\n\nDynamicScene.propTypes = {\n  sceneJSON: PropTypes.shape().isRequired,\n};\n\nexport default memo(DynamicScene);\n"],"sourceRoot":""}